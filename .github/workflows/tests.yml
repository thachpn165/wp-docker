name: Run Tests

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Install Bats
      run: |
        sudo apt-get update
        sudo apt-get install -y bats
    
    - name: Install Docker
      run: |
        sudo apt-get update
        sudo apt-get install -y docker.io
        sudo systemctl start docker
        sudo systemctl enable docker
    
    - name: Install Docker Compose
      run: |
        sudo curl -L "https://github.com/docker/compose/releases/download/v2.24.5/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
        sudo chmod +x /usr/local/bin/docker-compose
    
    - name: Run Website Management Tests
      run: bats tests/website/website_management.bats
    
    - name: Run WordPress Setup Tests
      run: bats tests/wordpress/wordpress_setup.bats
    
    - name: Run Docker Management Tests
      run: bats tests/docker/docker_management.bats
    
    - name: Run File Management Tests
      run: bats tests/file/file_management.bats
    
    - name: Run Network and SSL Tests
      run: bats tests/network/network_ssl.bats
    
    - name: Run Database Management Tests
      run: bats tests/db/database_management.bats
    
    - name: Run PHP Management Tests
      run: bats tests/php/php_management.bats 